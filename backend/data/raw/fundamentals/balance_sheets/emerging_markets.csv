import pandas as pd
from datetime import date
import os

def build_em_balance_sheets(as_of: str | None = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("Brazil",as_of,2.5e12,7.5e11,1.3e12,1.73,2.0e11,1.2,4.5,0.12,0.07,"High commodity leverage"),
        ("India",as_of,3.2e12,1.1e12,1.6e12,1.45,2.5e11,1.3,5.2,0.14,0.08,"Infrastructure-driven leverage"),
        ("China",as_of,15.0e12,4.5e12,7.5e12,1.67,1.0e12,1.1,3.8,0.11,0.06,"Corporate debt overhang"),
        ("South Africa",as_of,9.0e11,2.5e11,5.0e11,2.00,7.0e10,1.0,3.2,0.10,0.05,"High FX-denominated debt"),
        ("Mexico",as_of,1.5e12,4.5e11,7.5e11,1.67,1.2e11,1.1,3.9,0.12,0.07,"US-linked trade balance"),
        ("Turkey",as_of,8.0e11,2.0e11,5.0e11,2.50,5.0e10,0.9,2.5,0.08,0.04,"Inflation & currency exposure"),
        ("EM Avg",as_of,23.3e12,7.6e12,16.4e12,1.77,1.6e12,1.1,3.9,0.11,0.06,"Weighted EM balance sheet"),
    ]

    df = pd.DataFrame(rows, columns=[
        "country","as_of","total_assets","total_equity","total_debt",
        "debt_to_equity","cash_holdings","current_ratio","interest_coverage",
        "roe","roa","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_em_balance_sheets()
    out_path = "data/adamodar/curated/balance_sheets/emerging_markets.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… EM balance sheets dataset written to {out_path}")