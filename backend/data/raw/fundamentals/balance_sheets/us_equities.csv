import pandas as pd
from datetime import date
import os

def build_us_equities(as_of: str | None = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("Large Cap",as_of,30e12,0.052,0.037,0.88,1.00,18,3.5,10.0,0.015,"S&P 500 proxy"),
        ("Small Cap",as_of,3e12,0.060,0.037,0.95,1.20,14,1.8,8.0,0.020,"Russell 2000 proxy"),
        ("Growth",as_of,7e12,0.050,0.037,0.90,1.05,25,5.0,14.0,0.010,"Nasdaq 100 proxy"),
        ("Value",as_of,5e12,0.055,0.037,0.92,1.10,13,1.6,8.2,0.030,"Russell 1000 Value proxy"),
        ("Dividend",as_of,2e12,0.048,0.037,0.85,0.95,16,2.0,9.0,0.040,"High yield equity index"),
        ("Tech Sector",as_of,12e12,0.050,0.037,0.95,1.10,23,6.0,13.0,0.012,"Sector tilt: Technology"),
        ("Energy",as_of,3e12,0.058,0.037,1.05,1.25,10,1.3,6.5,0.050,"Sector tilt: Energy cyclical"),
        ("US Avg",as_of,62e12,0.052,0.037,0.90,1.05,17,3.0,9.5,0.018,"Weighted average across styles"),
    ]

    df = pd.DataFrame(rows, columns=[
        "style","as_of","market_cap_usd","erp_implied","rf_rate",
        "unlevered_beta","levered_beta","pe","pb","ev_ebitda",
        "dividend_yield","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_us_equities()
    out_path = "data/adamodar/curated/us_equities.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… US equities dataset written to {out_path}")