import pandas as pd
from datetime import date
import os

def build_liquidity_ratios(as_of: str | None = None) -> pd.DataFrame:
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("United States",as_of,1.5,1.2,0.5,0.40,"Strong liquidity buffers"),
        ("Developed ex-US",as_of,1.4,1.1,0.4,0.35,"Healthy but slightly lower"),
        ("Emerging Mkts",as_of,1.2,0.9,0.3,0.25,"Tighter liquidity conditions"),
        ("Frontier Mkts",as_of,1.0,0.8,0.2,0.15,"Fragile liquidity"),
        ("Global Avg",as_of,1.3,1.0,0.35,0.30,"Weighted global liquidity"),
    ]

    df = pd.DataFrame(rows, columns=[
        "region","as_of","current_ratio","quick_ratio","cash_ratio",
        "operating_cf_to_debt","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_liquidity_ratios()
    out_path = "data/adamodar/curated/liquidity_ratios.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… Liquidity ratios dataset written to {out_path}")