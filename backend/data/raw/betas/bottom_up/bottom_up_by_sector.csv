import pandas as pd
from datetime import date

def build_bottom_up_by_sector(as_of: str = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("Communication Services",as_of,0.83,0.32,0.21,1.03,720,"Media + telecom mix"),
        ("Consumer Discretionary",as_of,0.89,0.48,0.23,1.15,1050,"Retail, autos, leisure"),
        ("Consumer Staples",as_of,0.61,0.21,0.22,0.73,640,"Food, beverages, household"),
        ("Energy",as_of,1.02,0.55,0.20,1.34,680,"Oil & gas majors"),
        ("Financials",as_of,0.74,0.68,0.24,1.03,1450,"Leverage includes deposits"),
        ("Healthcare",as_of,0.68,0.24,0.21,0.83,960,"Pharma + biotech mix"),
        ("Industrials",as_of,0.92,0.43,0.22,1.15,1320,"Manufacturing, transports"),
        ("Materials",as_of,0.95,0.50,0.22,1.22,730,"Metals, chemicals, building"),
        ("Real Estate",as_of,0.60,0.88,0.23,0.92,470,"REITs, property developers"),
        ("Technology",as_of,0.95,0.24,0.21,1.11,1590,"Software + hardware mix"),
        ("Utilities",as_of,0.42,0.82,0.25,0.65,390,"Regulated utilities"),
    ]

    df = pd.DataFrame(rows, columns=[
        "sector","as_of","unlevered_beta",
        "avg_debt_to_equity","tax_rate",
        "levered_beta","n_firms","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_bottom_up_by_sector()
    out_path = "data/adamodar/raw/betas/bottom_up/by_sector.csv"
    df.to_csv(out_path, index=False)
    print(f"âœ… bottom_up by sector snapshot written to {out_path}")