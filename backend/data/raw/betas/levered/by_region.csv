import pandas as pd
from datetime import date

def build_betas_by_region(as_of: str = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("North America",as_of,0.88,1.09,0.40,0.23,0.41,0.11,3800,"Weighted US + Canada"),
        ("Europe",as_of,0.85,1.10,0.45,0.24,0.39,0.12,4100,"Eurozone + UK"),
        ("Asia Pacific",as_of,0.92,1.15,0.50,0.25,0.42,0.12,5200,"Japan, China, India, ASEAN"),
        ("Latin America",as_of,0.95,1.19,0.55,0.26,0.38,0.14,1600,"Brazil, Mexico, Chile, others"),
        ("Middle East",as_of,1.00,1.25,0.60,0.25,0.36,0.15,950,"Oil-weighted economies"),
        ("Africa",as_of,1.05,1.32,0.65,0.28,0.33,0.16,700,"High CRP + volatility"),
        ("Global",as_of,0.90,1.12,0.47,0.24,0.40,0.12,16450,"Weighted global average"),
    ]

    df = pd.DataFrame(rows, columns=[
        "region","as_of","unlevered_beta","levered_beta",
        "avg_debt_to_equity","tax_rate","r2","beta_std_err",
        "n_firms","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_betas_by_region()
    out_path = "data/adamodar/curated/betas_by_region.csv"
    df.to_csv(out_path, index=False)
    print(f"âœ… betas_by_region.csv written to {out_path}")