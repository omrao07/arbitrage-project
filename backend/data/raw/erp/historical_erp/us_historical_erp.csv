import pandas as pd
import os

def build_us_historical_erp():
    rows = [
        (2010,0.035,0.065,0.030,0.045,"Post-crisis ERP elevated"),
        (2011,0.030,0.065,0.035,0.020,"Eurozone debt fears"),
        (2012,0.020,0.060,0.040,0.015,"QE era, low rates, ERP widened"),
        (2013,0.025,0.055,0.030,0.050,"Market rally, strong realized"),
        (2014,0.030,0.055,0.025,0.060,"ERP narrowing, rally continues"),
        (2015,0.025,0.050,0.025,0.020,"Flat equity returns"),
        (2016,0.020,0.055,0.035,0.090,"Election year rally"),
        (2017,0.025,0.050,0.025,0.190,"Exceptional realized return"),
        (2018,0.030,0.060,0.030,-0.060,"Trade war & correction"),
        (2019,0.020,0.055,0.035,0.310,"Fed pivot, massive rally"),
        (2020,0.010,0.065,0.055,0.160,"COVID crash + stimulus rebound"),
        (2021,0.015,0.055,0.040,0.280,"Earnings recovery"),
        (2022,0.035,0.065,0.030,-0.180,"Inflation + rate shocks"),
        (2023,0.040,0.060,0.020,0.250,"Market bounce post-2022"),
        (2024,0.038,0.058,0.020,None,"ERP stabilizing"),
    ]

    df = pd.DataFrame(rows, columns=[
        "year","rf_rate","earnings_yield","implied_erp","realized_erp","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_us_historical_erp()
    out_path = "data/adamodar/curated/us_historical_erp.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… US historical ERP dataset written to {out_path}")