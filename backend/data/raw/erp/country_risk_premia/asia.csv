import pandas as pd
from datetime import date
import os

def build_asia_dataset(as_of: str | None = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("China",as_of,0.068,0.015,0.030,0.90,1.10,0.40,0.25,4500,14,1.8,7.5,0.020,"ERP w/ regulation risk adj."),
        ("India",as_of,0.072,0.020,0.065,0.95,1.20,0.60,0.25,2200,18,2.4,9.0,0.015,"Higher CRP, growth premium"),
        ("Japan",as_of,0.048,0.000,0.010,0.85,0.95,0.25,0.23,3500,16,1.3,8.0,0.025,"Deflation-adjusted ERP"),
        ("South Korea",as_of,0.060,0.010,0.025,0.92,1.05,0.35,0.24,1100,13,1.2,7.2,0.018,"Export-heavy, semis focus"),
        ("Taiwan",as_of,0.058,0.008,0.020,0.91,1.03,0.30,0.23,800,15,1.6,7.8,0.020,"Semiconductor concentration"),
        ("ASEAN Avg",as_of,0.065,0.020,0.040,0.95,1.15,0.50,0.25,1600,14,1.5,7.5,0.022,"Weighted average of ASEAN bloc"),
        ("Asia Avg",as_of,0.061,0.014,0.032,0.91,1.08,0.39,0.24,13700,15,1.6,7.8,0.020,"Weighted average across Asia"),
    ]

    df = pd.DataFrame(rows, columns=[
        "country","as_of","erp_implied","crp","rf_rate",
        "unlevered_beta","levered_beta","avg_debt_to_equity","tax_rate",
        "n_firms","pe","pb","ev_ebitda","dividend_yield","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_asia_dataset()
    out_path = "data/adamodar/curated/regions/asia.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… Asia dataset written to {out_path}")