import pandas as pd
from datetime import date
import os

def build_africa_dataset(as_of: str | None = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("South Africa",as_of,0.072,0.050,0.085,1.00,1.30,0.65,0.28,200,11,1.4,6.0,0.045,"JSE listed, FX risk high"),
        ("Nigeria",as_of,0.090,0.060,0.100,1.05,1.35,0.70,0.30,120,9,1.2,5.5,0.055,"Oil exposed + inflation risk"),
        ("Kenya",as_of,0.080,0.045,0.075,0.95,1.25,0.60,0.27,75,12,1.5,6.2,0.040,"Nairobi exchange"),
        ("Egypt",as_of,0.085,0.055,0.090,1.02,1.28,0.68,0.29,90,10,1.3,5.8,0.050,"Inflation + FX reserves issues"),
        ("Morocco",as_of,0.078,0.040,0.065,0.92,1.20,0.55,0.26,60,13,1.6,6.5,0.035,"Relatively stable"),
        ("Frontier Avg",as_of,0.083,0.050,0.083,0.99,1.28,0.64,0.28,545,11,1.4,6.0,0.045,"Weighted across Africa"),
    ]

    df = pd.DataFrame(rows, columns=[
        "country","as_of","erp_implied","crp","rf_rate",
        "unlevered_beta","levered_beta","avg_debt_to_equity","tax_rate",
        "n_firms","pe","pb","ev_ebitda","dividend_yield","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_africa_dataset()
    out_path = "data/adamodar/curated/regions/africa.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… Africa dataset written to {out_path}")