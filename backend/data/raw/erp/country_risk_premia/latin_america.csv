import pandas as pd
from datetime import date
import os

def build_latam_dataset(as_of: str | None = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("Brazil",as_of,0.080,0.035,0.070,0.98,1.20,0.55,0.27,600,9,1.3,6.0,0.050,"Commodities + political risk"),
        ("Mexico",as_of,0.075,0.030,0.065,0.95,1.15,0.50,0.26,400,11,1.5,7.0,0.035,"US trade linkage"),
        ("Chile",as_of,0.073,0.025,0.060,0.93,1.12,0.48,0.25,180,12,1.6,7.2,0.030,"Copper-heavy economy"),
        ("Argentina",as_of,0.095,0.050,0.090,1.05,1.35,0.70,0.30,120,8,1.1,5.5,0.060,"Inflation + default risk"),
        ("Peru",as_of,0.078,0.028,0.063,0.94,1.13,0.52,0.26,100,11,1.4,6.8,0.033,"Mining-driven"),
        ("Colombia",as_of,0.082,0.032,0.067,0.96,1.16,0.54,0.27,90,10,1.3,6.5,0.038,"Oil + FX volatility"),
        ("LatAm Avg",as_of,0.080,0.033,0.069,0.97,1.18,0.55,0.27,1490,10,1.4,6.5,0.041,"Weighted average across LatAm"),
    ]

    df = pd.DataFrame(rows, columns=[
        "country","as_of","erp_implied","crp","rf_rate",
        "unlevered_beta","levered_beta","avg_debt_to_equity","tax_rate",
        "n_firms","pe","pb","ev_ebitda","dividend_yield","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_latam_dataset()
    out_path = "data/adamodar/curated/regions/latin_america.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… Latin America dataset written to {out_path}")