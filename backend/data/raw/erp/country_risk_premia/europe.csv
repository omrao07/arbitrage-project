import pandas as pd
from datetime import date
import os

def build_europe_dataset(as_of: str | None = None):
    if as_of is None:
        as_of = str(date.today())

    rows = [
        ("Germany",as_of,0.050,0.000,0.025,0.85,1.05,0.40,0.24,800,14,1.5,8.0,0.030,"Eurozone anchor"),
        ("France",as_of,0.051,0.000,0.025,0.86,1.06,0.42,0.24,700,15,1.6,8.2,0.028,"Large CAC40 multinationals"),
        ("UK",as_of,0.053,0.002,0.030,0.88,1.08,0.45,0.23,900,13,1.4,7.5,0.035,"Brexit-adjusted risk premium"),
        ("Italy",as_of,0.055,0.005,0.035,0.92,1.15,0.55,0.26,400,12,1.2,7.0,0.040,"Sovereign spread sensitivity"),
        ("Spain",as_of,0.054,0.004,0.033,0.91,1.13,0.50,0.25,350,13,1.3,7.2,0.038,"Post-crisis reforms"),
        ("Nordics Avg",as_of,0.049,0.000,0.020,0.82,1.00,0.35,0.22,300,16,1.7,8.5,0.032,"Sweden, Denmark, Norway, etc."),
        ("Europe Avg",as_of,0.051,0.002,0.028,0.87,1.07,0.44,0.24,3450,14,1.5,7.8,0.032,"Weighted average across Europe"),
    ]

    df = pd.DataFrame(rows, columns=[
        "country","as_of","erp_implied","crp","rf_rate",
        "unlevered_beta","levered_beta","avg_debt_to_equity","tax_rate",
        "n_firms","pe","pb","ev_ebitda","dividend_yield","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_europe_dataset()
    out_path = "data/adamodar/curated/regions/europe.csv"
    os.makedirs(os.path.dirname(out_path), exist_ok=True)
    df.to_csv(out_path, index=False)
    print(f"âœ… Europe dataset written to {out_path}")