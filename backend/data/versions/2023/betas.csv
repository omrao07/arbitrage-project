import pandas as pd

def build_betas_2023():
    rows = [
        ("Communication Services","US","2023-01-01",0.84,1.06,0.33,0.21,0.11,0.40,130,""),
        ("Consumer Discretionary","US","2023-01-01",0.90,1.18,0.49,0.23,0.13,0.43,400,""),
        ("Consumer Staples","US","2023-01-01",0.61,0.73,0.21,0.22,0.09,0.37,220,""),
        ("Energy","US","2023-01-01",1.02,1.34,0.57,0.20,0.17,0.32,145,"Post-Ukraine war shock"),
        ("Financials","US","2023-01-01",0.74,1.02,0.68,0.24,0.15,0.39,550,"Includes deposits leverage"),
        ("Healthcare","US","2023-01-01",0.67,0.82,0.24,0.21,0.10,0.40,370,""),
        ("Industrials","US","2023-01-01",0.93,1.16,0.45,0.22,0.12,0.44,500,""),
        ("Materials","US","2023-01-01",0.95,1.21,0.51,0.22,0.13,0.40,270,""),
        ("Real Estate","US","2023-01-01",0.59,0.91,0.88,0.23,0.12,0.36,180,"REIT leverage net debt"),
        ("Technology","US","2023-01-01",0.95,1.12,0.24,0.21,0.11,0.45,620,"Tech rebound after 2022"),
        ("Utilities","US","2023-01-01",0.41,0.64,0.83,0.25,0.09,0.33,135,"Regulated utilities"),
    ]
    df = pd.DataFrame(rows, columns=[
        "sector","region","as_of",
        "unlevered_beta","levered_beta",
        "debt_to_equity","tax_rate",
        "beta_std_err","r2",
        "n_firms","notes"
    ])
    return df

if __name__ == "__main__":
    df = build_betas_2023()
    out_path = "data/adamodar/versions/2023/betas.csv"
    df.to_csv(out_path, index=False)
    print(f"âœ… betas.csv snapshot written to {out_path}")